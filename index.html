<div id = "err"></div><br>
<table class="outer">
	<tr class="outer">
		<th class="outer"><h3 style="color:#F00">Matriz 1</h3></th>
		<th class="outer"><h3 style="color:#00F">Matriz 2</h3></th>
		<th class="outer"><h3 style="color:#0F0">Resultado</h3></th>
	</tr>
	<tr class="outer"  style = "display : none">
		<td>
			<center>
				<table id = "tabela_matriz_1" style = "display:none;"></table>
			</center>
		</td>
		<td>
			<center>
				<table id = "tabela_matriz_2" style = "display:none;"></table>
			</center>
		</td>
		<td>
			<center>
				<table id = "tabela_matriz_3" style = "display:none;"></table>
			</center>
		</td>
	</tr>
	<tr class="outer">
		<td class = "outer">
			<!--<center>-->
				<br>
				<input id="coluna_amount_1" placeholder = "# de colunas" style = "width:90;vertical-align:bottom;">
				<button onclick = "alterTable('1');">Alterar</button>
			<!--</center>-->
		</td>
		<td class = "outer">
			<!--<center>-->
				<br>
				<input id="coluna_amount_2" placeholder = "# de colunas" style = "width:90;vertical-align:bottom;">
				<button onclick = "alterTable('2');">Alterar</button>
			<!--</center>-->
		</td>
		<td class = "outer">
			<canvas id="display">
			</canvas>
		</td>
	</tr>
</table>
<button onclick = "sum();">Somar</button>
<button onclick = "sub();">Subtrair</button>

<style>
.outer,table{
	border : none;
	padding : 0 0 0 0;
	margin : 0 0 0 0;
	background-color : #FFF;
}
table.outer
{
	background-color : #000;
}
</style>

<script>
var matrix_size = function(width,height)
{
	this.width = width;
	this.height = height;
}

var Point = function(x,y){this.x = x; this.y = y};

var m1 = new matrix_size(0,0);
var m2 = new matrix_size(0,0);
var m3 = new matrix_size(0,0);

var canvas = document.getElementById("display");
var ctx = canvas.getContext("2d");

function sum()
{
	var t1 = document.getElementById("tabela_matriz_1");
	var t2 = document.getElementById("tabela_matriz_2");
	var t3 = document.getElementById("tabela_matriz_3");
	if(m1.width != 0 && m1.height != 0 && m1.width == m2.width && m1.height == m2.height)
	{
		replaceNulls('1');
		replaceNulls('2');
		changeTableSize('3',m1);
		
		//sum
		for(var i=0; i<m1.width; i++)
		{
			for(var j=0; j<m1.height; j++)
			{
				var _td1 = document.getElementById("t_1_" + i + "_" + j);
				var _td2 = document.getElementById("t_2_" + i + "_" + j);
				var _td3 = document.getElementById("t_3_" + i + "_" + j);
				_td3.value = parseInt(_td1.value) + parseInt(_td2.value);
			}
		}
		DrawAllMatrix();
	}
	else
		err("O tamanho das matrizes precisa ser o mesmo para somar");
}

function sub()
{
	var t1 = document.getElementById("tabela_matriz_1");
	var t2 = document.getElementById("tabela_matriz_2");
	var t3 = document.getElementById("tabela_matriz_3");
	if(m1.width != 0 && m1.height != 0 && m1.width == m2.width && m1.height == m2.height)
	{
		replaceNulls('1');
		replaceNulls('2');
		changeTableSize('3',m1);
		
		//sum
		for(var i=0; i<m1.width; i++)
		{
			for(var j=0; j<m1.height; j++)
			{
				var _td1 = document.getElementById("t_1_" + i + "_" + j);
				var _td2 = document.getElementById("t_2_" + i + "_" + j);
				var _td3 = document.getElementById("t_3_" + i + "_" + j);
				_td3.value = parseInt(_td1.value) - parseInt(_td2.value);
			}
		}
		DrawAllMatrix();
	}
	else
		err("O tamanho das matrizes precisa ser o mesmo para somar");
}

function err(str)
{
	//error
	console.log(str);
	document.getElementById("err").innerText = str;
}

function replaceNulls(id)
{
	var t_size = parseInt(id) == 1 ? m1 : m2;
	for(var i=0; i<m1.width; i++)
	{
		for(var j=0; j<m1.height; j++)
		{
			var _input = document.getElementById("t_" + id + "_" + i + "_" + j);
			if(_input.value == "")
				_input.value = "0";
		}
	}
}

function alterTable(id)
{
	var i_m = 2;
	var j_m = parseInt(document.getElementById("coluna_amount_" + id).value);
	if(j_m > 0 && i_m > 0)
	{
		switch(parseInt(id))
		{
			case 1:
				m1 = new matrix_size(i_m,j_m);
				break;
			case 2:
				m2 = new matrix_size(i_m,j_m);
				break;
		}			
		changeTableSize(id, new matrix_size(i_m, j_m));
	}
}

function changeTableSize(id,size)
{
	var i_m = size.width;
	var j_m = size.height;
	if(id + "" == "3")
		m3 = size;
	var count = 0;
	if(j_m > 0 && i_m > 0)
	{
		var t = document.getElementById("tabela_matriz_" + id);
		t.style.display = "block";
		t.parentElement.parentElement.parentElement.style.display = "";
		t.innerHTML = "";
		var t_t = "";
		for(var i = 0; i< i_m; i++)
		{
			t_t += "<tr>";
			for(var j = 0; j< j_m; j++)
			{
				t_t += "<td> <input id='t_" + id + "_" + i + "_" + j + "' style = 'width:30;height:28;text-align:center;'> </td>";
				count ++;
			}
			t_t += "</tr>";
		}
		t.innerHTML = t_t;
	}
}

function DrawAllMatrix()
{
	ctx.clearRect(0,0,canvas.width,canvas.height);
	DrawMatrix("1", "#F00");
	DrawMatrix("2", "#00F");
	DrawMatrix("3", "#0F0");
}

function DrawMatrix(id, color)
{
	replaceNulls(""+id);
	switch(id+"")
	{
		case "1":
			_matrix = m1;
			break;
		case "2":
			_matrix = m2;
			break;
		case "3":
			_matrix = m3;
			break;
	}
	var _j = _matrix.height-1;
	var lastPoint = new Point(parseInt(document.getElementById("t_" + id + "_" + 0 + "_" + _j).value),parseInt(document.getElementById("t_" + id + "_" + 1 + "_" + _j).value));
	for(var j=0; j<m1.height; j++)
	{
		var x = parseInt(document.getElementById("t_" + id + "_" + 0 + "_" + j).value);
		var y = parseInt(document.getElementById("t_" + id + "_" + 1 + "_" + j).value);
		DrawLine(lastPoint, new Point(x,y), color);
		lastPoint = new Point(x,y);
	}
}

function DrawLine(point1, point2, color)
{
	var scale_factor = 30;
	ctx.beginPath();
	ctx.moveTo(point1.x * scale_factor,point1.y * scale_factor);
	ctx.lineTo(point2.x * scale_factor, point2.y * scale_factor);
	ctx.strokeStyle = color;
	ctx.stroke();
}
</script>